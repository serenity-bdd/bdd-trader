{"name":"Buying and selling shares","id":"buying-and-selling-shares;buying-and-selling-shares","scenarioId":"classpath:features/portfolios/buying_and_selling_shares:Buying and selling shares","methodName":"Buying and selling shares","testSteps":[{"number":1,"description":"Given Tom Smith is a registered trader","duration":3387,"startTime":"2024-08-15T19:49:39.559561116Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":0,"children":[{"number":2,"description":"Tom registers a client Tom Smith","duration":3165,"startTime":"2024-08-15T19:49:39.780528648Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":1,"children":[{"number":3,"description":"Tom executes a POST on the resource /client","duration":2361,"startTime":"2024-08-15T19:49:39.824154066Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2,"children":[{"number":4,"description":"POST http://localhost:8080/api/client","duration":0,"startTime":"2024-08-15T19:49:43.335099143Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"POST","path":"http://localhost:8080/api/client","content":"{\n    \"id\": null,\n    \"firstName\": \"Tom\",\n    \"lastName\": \"Smith\",\n    \"email\": \"Tom@Smith.com\"\n}","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Type: application/json\nTransfer-Encoding: chunked\nDate: Thu, 15 Aug 2024 19:49:42 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","responseBody":"{\n    \"id\": 1,\n    \"firstName\": \"Tom\",\n    \"lastName\": \"Smith\",\n    \"email\": \"Tom@Smith.com\"\n}","statusCode":200},"precondition":false,"level":3}]},{"number":5,"description":"Tom executes a GET on the resource /client/{clientId}/portfolio","duration":164,"startTime":"2024-08-15T19:49:42.295959541Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2,"children":[{"number":6,"description":"GET http://localhost:8080/api/client/1/portfolio","duration":0,"startTime":"2024-08-15T19:49:43.335662251Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"GET","path":"http://localhost:8080/api/client/1/portfolio","content":"","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Type: application/json\nTransfer-Encoding: chunked\nDate: Thu, 15 Aug 2024 19:49:42 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","responseBody":"{\n    \"portfolioId\": 1,\n    \"clientId\": 1,\n    \"history\": [\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Deposit\",\n            \"amount\": 100000,\n            \"priceInCents\": 1,\n            \"id\": 1,\n            \"timestamp\": \"2024-08-15T19:49:42.099796540\",\n            \"totalInCents\": 100000\n        }\n    ],\n    \"marketPositions\": {\n        \"CASH\": {\n            \"securityCode\": \"CASH\",\n            \"amount\": 100000,\n            \"totalPurchasePriceInDollars\": 1000.0,\n            \"marketValueInDollars\": 0.01,\n            \"totalValueInDollars\": 1000.0,\n            \"profit\": 0.0\n        }\n    },\n    \"profit\": 0.0,\n    \"cash\": 1000.0\n}","statusCode":200},"precondition":false,"level":3}]}]}]},{"number":7,"description":"When he purchases 5 AAPL shares at $100 each","duration":192,"startTime":"2024-08-15T19:49:42.948611548Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":0,"children":[{"number":8,"description":"He place order","duration":171,"startTime":"2024-08-15T19:49:42.968793056Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":1,"children":[{"number":9,"description":"he executes a GET on the resource /client/{clientId}/portfolio","duration":57,"startTime":"2024-08-15T19:49:42.970844114Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2,"children":[{"number":10,"description":"GET http://localhost:8080/api/client/1/portfolio","duration":0,"startTime":"2024-08-15T19:49:43.336479543Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"GET","path":"http://localhost:8080/api/client/1/portfolio","content":"","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Type: application/json\nTransfer-Encoding: chunked\nDate: Thu, 15 Aug 2024 19:49:42 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","responseBody":"{\n    \"portfolioId\": 1,\n    \"clientId\": 1,\n    \"history\": [\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Deposit\",\n            \"amount\": 100000,\n            \"priceInCents\": 1,\n            \"id\": 1,\n            \"timestamp\": \"2024-08-15T19:49:42.099796540\",\n            \"totalInCents\": 100000\n        }\n    ],\n    \"marketPositions\": {\n        \"CASH\": {\n            \"securityCode\": \"CASH\",\n            \"amount\": 100000,\n            \"totalPurchasePriceInDollars\": 1000.0,\n            \"marketValueInDollars\": 0.01,\n            \"totalValueInDollars\": 1000.0,\n            \"profit\": 0.0\n        }\n    },\n    \"profit\": 0.0,\n    \"cash\": 1000.0\n}","statusCode":200},"precondition":false,"level":3}]},{"number":11,"description":"he executes a POST on the resource /portfolio/{portfolioId}/order","duration":86,"startTime":"2024-08-15T19:49:43.051573120Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2,"children":[{"number":12,"description":"POST http://localhost:8080/api/portfolio/1/order","duration":0,"startTime":"2024-08-15T19:49:43.336937896Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"POST","path":"http://localhost:8080/api/portfolio/1/order","content":"{\n    \"securityCode\": \"AAPL\",\n    \"type\": \"Buy\",\n    \"amount\": 5,\n    \"priceInCents\": 10000,\n    \"id\": 2,\n    \"timestamp\": \"2024-08-15T19:49:43.056344071\",\n    \"totalInCents\": 50000\n}","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Type: application/json\nTransfer-Encoding: chunked\nDate: Thu, 15 Aug 2024 19:49:43 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","responseBody":"{\n    \"portfolioId\": 1,\n    \"clientId\": 1,\n    \"history\": [\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Deposit\",\n            \"amount\": 100000,\n            \"priceInCents\": 1,\n            \"id\": 1,\n            \"timestamp\": \"2024-08-15T19:49:42.099796540\",\n            \"totalInCents\": 100000\n        },\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Sell\",\n            \"amount\": 50000,\n            \"priceInCents\": 1,\n            \"id\": 8,\n            \"timestamp\": \"2024-08-15T19:49:43.109496855\",\n            \"totalInCents\": 50000\n        },\n        {\n            \"securityCode\": \"AAPL\",\n            \"type\": \"Buy\",\n            \"amount\": 5,\n            \"priceInCents\": 10000,\n            \"id\": 2,\n            \"timestamp\": \"2024-08-15T19:49:43.056344071\",\n            \"totalInCents\": 50000\n        }\n    ],\n    \"cash\": 500.0\n}","statusCode":200},"precondition":false,"level":3}]},{"number":13,"description":"Then the response status should be (200)","duration":0,"startTime":"2024-08-15T19:49:43.139285738Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2}]}]},{"number":14,"description":"And he sells 3 AAPL shares for $150 each","duration":98,"startTime":"2024-08-15T19:49:43.141414310Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":0,"children":[{"number":15,"description":"He place order","duration":96,"startTime":"2024-08-15T19:49:43.143365994Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":1,"children":[{"number":16,"description":"he executes a GET on the resource /client/{clientId}/portfolio","duration":29,"startTime":"2024-08-15T19:49:43.145686443Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2,"children":[{"number":17,"description":"GET http://localhost:8080/api/client/1/portfolio","duration":0,"startTime":"2024-08-15T19:49:43.337777218Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"GET","path":"http://localhost:8080/api/client/1/portfolio","content":"","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Type: application/json\nTransfer-Encoding: chunked\nDate: Thu, 15 Aug 2024 19:49:43 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","responseBody":"{\n    \"portfolioId\": 1,\n    \"clientId\": 1,\n    \"history\": [\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Deposit\",\n            \"amount\": 100000,\n            \"priceInCents\": 1,\n            \"id\": 1,\n            \"timestamp\": \"2024-08-15T19:49:42.099796540\",\n            \"totalInCents\": 100000\n        },\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Sell\",\n            \"amount\": 50000,\n            \"priceInCents\": 1,\n            \"id\": 8,\n            \"timestamp\": \"2024-08-15T19:49:43.109496855\",\n            \"totalInCents\": 50000\n        },\n        {\n            \"securityCode\": \"AAPL\",\n            \"type\": \"Buy\",\n            \"amount\": 5,\n            \"priceInCents\": 10000,\n            \"id\": 2,\n            \"timestamp\": \"2024-08-15T19:49:43.056344071\",\n            \"totalInCents\": 50000\n        }\n    ],\n    \"marketPositions\": {\n        \"CASH\": {\n            \"securityCode\": \"CASH\",\n            \"amount\": 50000,\n            \"totalPurchasePriceInDollars\": 500.0,\n            \"marketValueInDollars\": 0.01,\n            \"totalValueInDollars\": 500.0,\n            \"profit\": 0.0\n        },\n        \"AAPL\": {\n            \"securityCode\": \"AAPL\",\n            \"amount\": 5,\n            \"totalPurchasePriceInDollars\": 500.0,\n            \"marketValueInDollars\": 190.24,\n            \"totalValueInDollars\": 951.2,\n            \"profit\": 451.2\n        }\n    },\n    \"profit\": 451.2,\n    \"cash\": 500.0\n}","statusCode":200},"precondition":false,"level":3}]},{"number":18,"description":"he executes a POST on the resource /portfolio/{portfolioId}/order","duration":43,"startTime":"2024-08-15T19:49:43.193868562Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2,"children":[{"number":19,"description":"POST http://localhost:8080/api/portfolio/1/order","duration":0,"startTime":"2024-08-15T19:49:43.338209032Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"POST","path":"http://localhost:8080/api/portfolio/1/order","content":"{\n    \"securityCode\": \"AAPL\",\n    \"type\": \"Sell\",\n    \"amount\": 3,\n    \"priceInCents\": 15000,\n    \"id\": 4,\n    \"timestamp\": \"2024-08-15T19:49:43.195707926\",\n    \"totalInCents\": 45000\n}","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Type: application/json\nTransfer-Encoding: chunked\nDate: Thu, 15 Aug 2024 19:49:43 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","responseBody":"{\n    \"portfolioId\": 1,\n    \"clientId\": 1,\n    \"history\": [\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Deposit\",\n            \"amount\": 100000,\n            \"priceInCents\": 1,\n            \"id\": 1,\n            \"timestamp\": \"2024-08-15T19:49:42.099796540\",\n            \"totalInCents\": 100000\n        },\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Sell\",\n            \"amount\": 50000,\n            \"priceInCents\": 1,\n            \"id\": 8,\n            \"timestamp\": \"2024-08-15T19:49:43.109496855\",\n            \"totalInCents\": 50000\n        },\n        {\n            \"securityCode\": \"AAPL\",\n            \"type\": \"Buy\",\n            \"amount\": 5,\n            \"priceInCents\": 10000,\n            \"id\": 2,\n            \"timestamp\": \"2024-08-15T19:49:43.056344071\",\n            \"totalInCents\": 50000\n        },\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Buy\",\n            \"amount\": 45000,\n            \"priceInCents\": 1,\n            \"id\": 12,\n            \"timestamp\": \"2024-08-15T19:49:43.230630514\",\n            \"totalInCents\": 45000\n        },\n        {\n            \"securityCode\": \"AAPL\",\n            \"type\": \"Sell\",\n            \"amount\": 3,\n            \"priceInCents\": 15000,\n            \"id\": 4,\n            \"timestamp\": \"2024-08-15T19:49:43.195707926\",\n            \"totalInCents\": 45000\n        }\n    ],\n    \"cash\": 950.0\n}","statusCode":200},"precondition":false,"level":3}]},{"number":20,"description":"Then the response status should be (200)","duration":0,"startTime":"2024-08-15T19:49:43.238467773Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2}]}]},{"number":21,"description":"Then he should have the following positions:\n| securityCode | amount |\n| CASH | 95000 |\n| AAPL | 2 |","duration":29,"startTime":"2024-08-15T19:49:43.240301396Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":0,"children":[{"number":22,"description":"he executes a GET on the resource /client/{clientId}/portfolio/positions","duration":16,"startTime":"2024-08-15T19:49:43.242703478Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":1,"children":[{"number":23,"description":"GET http://localhost:8080/api/client/1/portfolio/positions","duration":0,"startTime":"2024-08-15T19:49:43.338971191Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"GET","path":"http://localhost:8080/api/client/1/portfolio/positions","content":"","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Type: application/json\nTransfer-Encoding: chunked\nDate: Thu, 15 Aug 2024 19:49:43 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","responseBody":"[\n    {\n        \"securityCode\": \"AAPL\",\n        \"amount\": 2,\n        \"totalPurchasePriceInDollars\": 50.0,\n        \"marketValueInDollars\": 190.24,\n        \"totalValueInDollars\": 380.48,\n        \"profit\": 330.48\n    },\n    {\n        \"securityCode\": \"CASH\",\n        \"amount\": 95000,\n        \"totalPurchasePriceInDollars\": 950.0,\n        \"marketValueInDollars\": 0.01,\n        \"totalValueInDollars\": 950.0,\n        \"profit\": 0.0\n    }\n]","statusCode":200},"precondition":false,"level":2}]}]}],"userStory":{"id":"classpath:features/portfolios/buying_and_selling_shares","storyName":"Buying and selling shares","displayName":"Buying and selling shares","path":"portfolios/buying_and_selling_shares","pathElements":[{"name":"portfolios","description":""},{"name":"buying_and_selling_shares","description":""}],"narrative":"  In order to make my investments grow\n  As a trader\n  I want to be able to buy and sell shares to make a profit\n\n  All traders start with $1000 in cash in their portfolio\n  CASH amounts are recorded in cents, so 50000 represents $500\n\n  Key capabilities include the ability to buy and sell shares, e.g.\n\n  {Scenario} Buying and selling shares","type":"feature"},"title":"Buying and selling shares","description":"","tags":[{"name":"trading","type":"tag","displayName":"trading"}],"startTime":"2024-08-15T19:49:39.440198139Z[Etc/UTC]","endTime":"2024-08-15T19:49:43.269869197Z[Etc/UTC]","duration":3894,"projectKey":"","isManualTestingUpToDate":false,"manual":false,"testSource":"Cucumber","actors":[{"name":"Tom"}],"result":"SUCCESS"}