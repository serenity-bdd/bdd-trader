{"name":"Making a profit on a single share","id":"viewing-positions;making-a-profit-on-a-single-share","scenarioId":"portfolios/viewing_positions:Making a profit on a single share","methodName":"Making a profit on a single share","testSteps":[{"number":1,"description":"Given the following market prices:\n| securityCode | price |\n| SNAP | 200 |\n| IBM | 60 |","duration":51,"startTime":"2023-07-15T18:57:21.219525567Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":0,"children":[{"number":2,"description":"Market Forces executes a POST on the resource /stock/{securityCode}/price","duration":25,"startTime":"2023-07-15T18:57:21.224597914Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":1,"children":[{"number":3,"description":"POST http://localhost:8080/api/stock/SNAP/price","duration":0,"startTime":"2023-07-15T18:57:21.250039651Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"POST","path":"http://localhost:8080/api/stock/SNAP/price","content":"","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Length: 0\nDate: Sat, 15 Jul 2023 18:57:21 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","statusCode":200},"precondition":false,"level":2}]},{"number":4,"description":"Market Forces executes a POST on the resource /stock/{securityCode}/price","duration":13,"startTime":"2023-07-15T18:57:21.255851419Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":1,"children":[{"number":5,"description":"POST http://localhost:8080/api/stock/IBM/price","duration":0,"startTime":"2023-07-15T18:57:21.269654019Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"POST","path":"http://localhost:8080/api/stock/IBM/price","content":"","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Length: 0\nDate: Sat, 15 Jul 2023 18:57:21 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","statusCode":200},"precondition":false,"level":2}]}]},{"number":6,"description":"And Sarah Smith is a registered trader","duration":65,"startTime":"2023-07-15T18:57:21.271703378Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":0,"children":[{"number":7,"description":"Sarah registers a client Sarah Smith","duration":60,"startTime":"2023-07-15T18:57:21.274823068Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":1,"children":[{"number":8,"description":"Sarah executes a POST on the resource /client","duration":21,"startTime":"2023-07-15T18:57:21.277257939Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2,"children":[{"number":9,"description":"POST http://localhost:8080/api/client","duration":0,"startTime":"2023-07-15T18:57:21.298466053Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"POST","path":"http://localhost:8080/api/client","content":"{\n    \"id\": null,\n    \"firstName\": \"Sarah\",\n    \"lastName\": \"Smith\",\n    \"email\": \"Sarah@Smith.com\"\n}","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Type: application/json\nTransfer-Encoding: chunked\nDate: Sat, 15 Jul 2023 18:57:21 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","responseBody":"{\n    \"id\": 4,\n    \"firstName\": \"Sarah\",\n    \"lastName\": \"Smith\",\n    \"email\": \"Sarah@Smith.com\"\n}","statusCode":200},"precondition":false,"level":3}]},{"number":10,"description":"Sarah executes a GET on the resource /client/{clientId}/portfolio","duration":17,"startTime":"2023-07-15T18:57:21.306738992Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2,"children":[{"number":11,"description":"GET http://localhost:8080/api/client/4/portfolio","duration":0,"startTime":"2023-07-15T18:57:21.324571809Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"GET","path":"http://localhost:8080/api/client/4/portfolio","content":"","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Type: application/json\nTransfer-Encoding: chunked\nDate: Sat, 15 Jul 2023 18:57:21 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","responseBody":"{\n    \"portfolioId\": 4,\n    \"clientId\": 4,\n    \"history\": [\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Deposit\",\n            \"amount\": 100000,\n            \"priceInCents\": 1,\n            \"id\": 10,\n            \"timestamp\": \"2023-07-15T18:57:21.290026708\",\n            \"totalInCents\": 100000\n        }\n    ],\n    \"marketPositions\": {\n        \"CASH\": {\n            \"securityCode\": \"CASH\",\n            \"amount\": 100000,\n            \"totalPurchasePriceInDollars\": 1000.0,\n            \"marketValueInDollars\": 0.01,\n            \"totalValueInDollars\": 1000.0,\n            \"profit\": 0.0\n        }\n    },\n    \"profit\": 0.0,\n    \"cash\": 1000.0\n}","statusCode":200},"precondition":false,"level":3}]}]}]},{"number":12,"description":"Given Sarah has purchased 5 SNAP shares at $100 each","duration":57,"startTime":"2023-07-15T18:57:21.337259076Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":0,"children":[{"number":13,"description":"Sarah place order","duration":54,"startTime":"2023-07-15T18:57:21.339271034Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":1,"children":[{"number":14,"description":"Sarah executes a GET on the resource /client/{clientId}/portfolio","duration":15,"startTime":"2023-07-15T18:57:21.341601602Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2,"children":[{"number":15,"description":"GET http://localhost:8080/api/client/4/portfolio","duration":0,"startTime":"2023-07-15T18:57:21.356567335Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"GET","path":"http://localhost:8080/api/client/4/portfolio","content":"","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Type: application/json\nTransfer-Encoding: chunked\nDate: Sat, 15 Jul 2023 18:57:21 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","responseBody":"{\n    \"portfolioId\": 4,\n    \"clientId\": 4,\n    \"history\": [\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Deposit\",\n            \"amount\": 100000,\n            \"priceInCents\": 1,\n            \"id\": 10,\n            \"timestamp\": \"2023-07-15T18:57:21.290026708\",\n            \"totalInCents\": 100000\n        }\n    ],\n    \"marketPositions\": {\n        \"CASH\": {\n            \"securityCode\": \"CASH\",\n            \"amount\": 100000,\n            \"totalPurchasePriceInDollars\": 1000.0,\n            \"marketValueInDollars\": 0.01,\n            \"totalValueInDollars\": 1000.0,\n            \"profit\": 0.0\n        }\n    },\n    \"profit\": 0.0,\n    \"cash\": 1000.0\n}","statusCode":200},"precondition":false,"level":3}]},{"number":16,"description":"Sarah executes a POST on the resource /portfolio/{portfolioId}/order","duration":19,"startTime":"2023-07-15T18:57:21.369026796Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2,"children":[{"number":17,"description":"POST http://localhost:8080/api/portfolio/4/order","duration":0,"startTime":"2023-07-15T18:57:21.388706565Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"POST","path":"http://localhost:8080/api/portfolio/4/order","content":"{\n    \"securityCode\": \"SNAP\",\n    \"type\": \"Buy\",\n    \"amount\": 5,\n    \"priceInCents\": 10000,\n    \"id\": 4,\n    \"timestamp\": \"2023-07-15T18:57:21.370627042\",\n    \"totalInCents\": 50000\n}","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Type: application/json\nTransfer-Encoding: chunked\nDate: Sat, 15 Jul 2023 18:57:21 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","responseBody":"{\n    \"portfolioId\": 4,\n    \"clientId\": 4,\n    \"history\": [\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Deposit\",\n            \"amount\": 100000,\n            \"priceInCents\": 1,\n            \"id\": 10,\n            \"timestamp\": \"2023-07-15T18:57:21.290026708\",\n            \"totalInCents\": 100000\n        },\n        {\n            \"securityCode\": \"CASH\",\n            \"type\": \"Sell\",\n            \"amount\": 50000,\n            \"priceInCents\": 1,\n            \"id\": 12,\n            \"timestamp\": \"2023-07-15T18:57:21.384184534\",\n            \"totalInCents\": 50000\n        },\n        {\n            \"securityCode\": \"SNAP\",\n            \"type\": \"Buy\",\n            \"amount\": 5,\n            \"priceInCents\": 10000,\n            \"id\": 4,\n            \"timestamp\": \"2023-07-15T18:57:21.370627042\",\n            \"totalInCents\": 50000\n        }\n    ],\n    \"cash\": 500.0\n}","statusCode":200},"precondition":false,"level":3}]},{"number":18,"description":"Then the response status should be (200)","duration":0,"startTime":"2023-07-15T18:57:21.392488375Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":2}]}]},{"number":19,"description":"Then she should have the following position details:\n| securityCode | amount | totalValueInDollars | profit |\n| CASH | 50000 | 500.00 | 0.00 |\n| SNAP | 5 | 1000.00 | 500.00 |","duration":27,"startTime":"2023-07-15T18:57:21.395554964Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":0,"children":[{"number":20,"description":"she executes a GET on the resource /client/{clientId}/portfolio/positions","duration":15,"startTime":"2023-07-15T18:57:21.398275242Z[Etc/UTC]","result":"SUCCESS","precondition":false,"level":1,"children":[{"number":21,"description":"GET http://localhost:8080/api/client/4/portfolio/positions","duration":0,"startTime":"2023-07-15T18:57:21.414033899Z[Etc/UTC]","result":"SUCCESS","restQuery":{"method":"GET","path":"http://localhost:8080/api/client/4/portfolio/positions","content":"","contentType":"application/json","requestHeaders":"Accept\u003d*/*\n\t\t\t\tContent-Type\u003dapplication/json","requestCookies":"","responseHeaders":"Content-Type: application/json\nTransfer-Encoding: chunked\nDate: Sat, 15 Jul 2023 18:57:21 GMT\nKeep-Alive: timeout\u003d60\nConnection: keep-alive","responseCookies":"","responseBody":"[\n    {\n        \"securityCode\": \"CASH\",\n        \"amount\": 50000,\n        \"totalPurchasePriceInDollars\": 500.0,\n        \"marketValueInDollars\": 0.01,\n        \"totalValueInDollars\": 500.0,\n        \"profit\": 0.0\n    },\n    {\n        \"securityCode\": \"SNAP\",\n        \"amount\": 5,\n        \"totalPurchasePriceInDollars\": 500.0,\n        \"marketValueInDollars\": 200.0,\n        \"totalValueInDollars\": 1000.0,\n        \"profit\": 500.0\n    }\n]","statusCode":200},"precondition":false,"level":2}]}]}],"userStory":{"id":"portfolios/viewing_positions","storyName":"Viewing positions","displayName":"Viewing positions","path":"portfolios/viewing_positions","pathElements":[{"name":"portfolios","description":""},{"name":"viewing_positions","description":""}],"narrative":"  In order to understand how my investments are doing\n  As a trader\n  I want to be able to see the profits and losses for my investments\n\n  All traders start with $1000 in cash in their portfolio\n  CASH amounts are recorded in cents, so 50000 represents $500","type":"feature"},"title":"Making a profit on a single share","description":"","backgroundTitle":"","backgroundDescription":"","tags":[{"name":"Linux","type":"context","displayName":"Linux"}],"startTime":"2023-07-15T18:57:21.216233872Z[Etc/UTC]","duration":207,"projectKey":"","isManualTestingUpToDate":false,"context":"linux","manual":false,"testSource":"Cucumber","actors":[{"name":"Market Forces","can":["call an API at http://localhost:8080/api"]},{"name":"Sarah","can":["call an API at http://localhost:8080/api"]}],"order":0,"result":"SUCCESS"}